---
title: "ChrisEscobedo_A4"
author: "Chris"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: html_document
---

```{r, include = F}
knitr::opts_chunk$set(echo = F, warnings = F, message = F)
```

```{r}
library(lehdr)
library(tidyverse)
library(tigris)
library(sf)
library(leaflet)
library(censusapi)
library(raster)
library(mapview)

Sys.setenv(CENSUS_KEY="c7ce771b506b13ca6875d12a179606f8087fa381")
```

## Location

The analysis centered on the Palo Verde neighborhood in the Northwestern area of Palo Alto. The map below shows the two census block groups that make up the neighborhood and which will be used for the analysis. 

```{r, warning = F}
slr <- 25
rp <- 20

path <- paste0("/Volumes/GoogleDrive/Shared drives/SFBI/Data Library/OCOF/san_mateo_flooding_slr",str_pad(slr, 3, "left", "0"), "/flooding/v2.1/county_san_mateo_flddepth_slr", str_pad(slr, 3, "left", "0"), "_w", str_pad(rp, 3, "left", "0"), ".tif")

test_flood <- raster(path)

# RW Shores CBGs - 060816103043, 060816103042, 	060816103041, 	060816103031,	060816103032, 	060816103033, 	060816103034
rws_boundary <- block_groups("CA", "San Mateo") %>% 
  filter(GEOID %in% c("060816103043", "060816103042", "060816103041", "060816103031",	"060816103032", "060816103033", 	"060816103034")) 

mapview(rws_boundary)

test_flood_rws <- test_flood %>% 
  crop(
    rws_boundary %>% 
      st_transform(26910) %>% 
      st_bbox()
  )

plot(test_flood_rws)
```


```{r, warning = F}
flood_pal <- colorNumeric(
  palette = "Blues",
  domain = values(test_flood_rws),
  na.color = "transparent"
)

leaflet() %>% 
  addMapboxTiles(
    style_id = "satellite-streets-v11",
    username = "mapbox",
    options = tileOptions(opacity = 0.5)
  ) %>% 
  addRasterImage(
    test_flood_rws,
    colors = flood_pal
  ) %>% 
  addLegend(
    pal = flood_pal,
    values = values(test_flood_rws),
    title = "Flood depth, cm"
  )
```

